@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  /* Design Token System */
  :root {
    color-scheme: light dark;
    font-family: var(--font-sans);
    
    /* Base tokens - theme agnostic */
    --font-sans: "Inter", "Segoe UI", system-ui, sans-serif;
    --font-mono: "Fira Code", "Courier New", monospace;
    
    /* Font sizes */
    --font-size-xs: 0.75rem;
    --font-size-sm: 0.875rem;
    --font-size-base: 1rem;
    --font-size-lg: 1.125rem;
    --font-size-xl: 1.25rem;
    --font-size-2xl: 1.5rem;
    --font-size-3xl: 1.875rem;
    
    /* Font weights */
    --font-weight-regular: 400;
    --font-weight-medium: 500;
    --font-weight-semibold: 600;
    --font-weight-bold: 700;
    
    /* Border radius */
    --radius-xs: 4px;
    --radius-sm: 6px;
    --radius-md: 8px;
    --radius-lg: 12px;
    --radius-full: 9999px;
    
    /* Motion */
    --motion-duration-quick: 120ms;
    --motion-duration-normal: 200ms;
    --motion-duration-slow: 320ms;
    --motion-ease-standard: cubic-bezier(0.2, 0, 0, 1);
    --motion-ease-emphasized: cubic-bezier(0.3, 0.7, 0.4, 1);
    
    /* Elevation - base values, adjusted per theme */
    --shadow-xs: 0 1px 2px rgba(var(--shadow-color-base-rgb), 0.08);
    --shadow-sm: 0 4px 12px rgba(var(--shadow-color-base-rgb), 0.12);
    --shadow-md: 0 12px 24px rgba(var(--shadow-color-base-rgb), 0.16);
  }
  
  /* Light theme tokens */
  :root[data-theme="light"] {
    --color-bg: #f8fafc;
    --color-surface: #ffffff;
    --color-subtle: #f1f5f9;
    --color-border: #cbd5e1;
    --color-text: #0f172a;
    --color-text-muted: #475569;
    --color-primary: #0284c7;
    --color-primary-contrast: #ffffff;
    --color-accent: #16a34a;
    --color-success: #15803d;
    --color-warning: #b45309;
    --color-danger: #dc2626;
    --shadow-color-base: rgba(15, 23, 42, 0.12);
    --shadow-color-base-rgb: 15, 23, 42;
  }
  
  /* Dark theme tokens */
  :root[data-theme="dark"] {
    --color-bg: #0b1120;
    --color-surface: #111c2f;
    --color-subtle: #1b2538;
    --color-border: #3f4a63;
    --color-text: #e2e8f0;
    --color-text-muted: #94a3b8;
    --color-primary: #38bdf8;
    --color-primary-contrast: #041423;
    --color-accent: #4ade80;
    --color-success: #22c55e;
    --color-warning: #f59e0b;
    --color-danger: #f87171;
    --shadow-color-base: rgba(8, 15, 30, 0.32);
    --shadow-color-base-rgb: 8, 15, 30;
  }

  body {
    background: var(--color-bg);
    color: var(--color-text);
    transition: color var(--motion-duration-normal) var(--motion-ease-standard),
                background-color var(--motion-duration-normal) var(--motion-ease-standard);
  }

  code,
  pre {
    @apply font-mono;
  }
}

@layer components {
  .btn {
    padding: 0.75rem 1.25rem;
    border-radius: var(--radius-md);
    font-weight: var(--font-weight-semibold);
    transition: all var(--motion-duration-normal) var(--motion-ease-standard);
    outline: none;
    border: none;
    cursor: pointer;
  }

  .btn:focus-visible {
    outline: 2px solid var(--color-primary);
    outline-offset: 2px;
  }

  .btn:disabled {
    opacity: 0.6;
    cursor: not-allowed;
  }

  .btn-primary {
    background: var(--color-primary);
    color: var(--color-primary-contrast);
  }

  .btn-primary:hover:not(:disabled) {
    transform: translateY(-1px);
    box-shadow: var(--shadow-sm);
  }

  .btn-secondary {
    background: var(--color-subtle);
    color: var(--color-text);
    border: 1px solid var(--color-border);
  }

  .btn-secondary:hover:not(:disabled) {
    background: var(--color-surface);
    border-color: var(--color-primary);
  }

  .btn-accent {
    background: var(--color-accent);
    color: var(--color-primary-contrast);
  }

  .btn-accent:hover:not(:disabled) {
    transform: translateY(-1px);
    box-shadow: var(--shadow-sm);
  }

  .tool-textarea {
    width: 100%;
    min-height: 200px;
    padding: 1rem;
    font-family: var(--font-mono);
    font-size: var(--font-size-sm);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    background: var(--color-surface);
    color: var(--color-text);
    outline: none;
    resize: vertical;
    transition: border-color var(--motion-duration-normal) var(--motion-ease-standard);
  }

  .tool-textarea:focus {
    border-color: var(--color-primary);
    box-shadow: 0 0 0 2px rgba(var(--shadow-color-base-rgb), 0.1);
  }

  .tool-textarea.error {
    border-color: var(--color-danger);
  }

  .tool-textarea:disabled {
    opacity: 0.6;
    cursor: not-allowed;
  }

  .tool-card {
    background: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    padding: 1.5rem;
    box-shadow: var(--shadow-xs);
    transition: border-color var(--motion-duration-normal) var(--motion-ease-standard),
                box-shadow var(--motion-duration-normal) var(--motion-ease-standard),
                transform var(--motion-duration-quick) var(--motion-ease-standard);
  }

  .tool-card:hover,
  .tool-card:focus-within {
    border-color: var(--color-primary);
    box-shadow: var(--shadow-sm);
    transform: translateY(-2px);
  }

  /* Enhanced Blog Article Styles - Using Design Tokens */
  .article-hero-gradient {
    background: var(--color-subtle);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    box-shadow: var(--shadow-sm);
    position: relative;
    padding: 2rem;
    overflow: hidden;
  }

  /* Theme-aware glow effect */
  .article-hero-gradient::before {
    content: "";
    position: absolute;
    inset: 0;
    background: linear-gradient(
      135deg,
      rgba(var(--shadow-color-base-rgb), 0.05) 0%,
      transparent 50%,
      rgba(var(--shadow-color-base-rgb), 0.05) 100%
    );
    pointer-events: none;
    border-radius: inherit;
  }

  .code-block-enhanced pre {
    position: relative;
    background: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    box-shadow: var(--shadow-sm);
    padding: 1.5rem;
    transition: border-color var(--motion-duration-normal) var(--motion-ease-standard),
                box-shadow var(--motion-duration-normal) var(--motion-ease-standard);
  }

  .code-block-enhanced pre:hover {
    border-color: var(--color-primary);
    box-shadow: var(--shadow-md);
  }

  .code-block-enhanced pre code {
    color: var(--color-text);
    font-family: var(--font-mono);
    font-size: var(--font-size-sm);
    line-height: 1.6;
  }

  .metadata-icon {
    width: 18px;
    height: 18px;
    color: var(--color-text-muted);
  }

  .article-animate {
    animation: fadeInUp var(--motion-duration-slow) var(--motion-ease-standard);
  }

  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* Motion Primitives - Phase 3 */
  .motion-fade-in {
    animation: motionFadeIn var(--motion-duration-normal) var(--motion-ease-standard);
  }

  .motion-elevate {
    transition: transform var(--motion-duration-quick) var(--motion-ease-standard),
                box-shadow var(--motion-duration-quick) var(--motion-ease-standard);
  }

  .motion-elevate:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-md);
  }

  .motion-slide-in-y-8 {
    animation: motionSlideInY8 var(--motion-duration-normal) var(--motion-ease-emphasized);
  }

  .motion-pulse-soft {
    animation: motionPulseSoft 2s var(--motion-ease-standard) infinite;
  }

  /* Motion keyframes */
  @keyframes motionFadeIn {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  @keyframes motionSlideInY8 {
    from {
      opacity: 0;
      transform: translateY(2rem);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes motionPulseSoft {
    0%, 100% {
      opacity: 1;
    }
    50% {
      opacity: 0.8;
    }
  }

  /* Reduced motion fallback */
  @media (prefers-reduced-motion: reduce) {
    .article-animate,
    .motion-fade-in,
    .motion-slide-in-y-8,
    .motion-pulse-soft {
      animation: none;
    }
    
    .motion-elevate {
      transition: none;
    }
    
    .motion-elevate:hover {
      transform: none;
    }
    
    #mobile-menu,
    #mobile-menu-backdrop {
      animation: none;
      transition: none;
    }
    
    * {
      animation-duration: 1ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 1ms !important;
    }
  }
}

@layer components {
  /* Screen reader only utility - shown on focus */
  .sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    white-space: nowrap;
    border: 0;
    clip: rect(0, 0, 0, 0);
  }

  .sr-only:focus {
    position: static;
    width: auto;
    height: auto;
    padding: 0.5rem;
    margin: 0;
    overflow: visible;
    white-space: normal;
    background: var(--color-primary);
    color: var(--color-primary-contrast);
    border-radius: var(--radius-md);
    clip: auto;
    outline: 2px solid var(--color-primary);
    outline-offset: 2px;
  }

  /* Navigation link active states */
  .nav-link.active,
  .mobile-nav-link.active {
    color: var(--color-primary);
    font-weight: var(--font-weight-semibold);
    background: var(--color-subtle);
    border-radius: var(--radius-sm);
    padding: 0.5rem 0.75rem;
  }

  .nav-link {
    position: relative;
    padding: 0.5rem 0.75rem;
    border-radius: var(--radius-sm);
    transition: color var(--motion-duration-quick) var(--motion-ease-standard),
                background-color var(--motion-duration-quick) var(--motion-ease-standard);
  }

  .nav-link:hover {
    background: var(--color-subtle);
  }

  .nav-link.active::after {
    content: "";
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 2px;
    background: var(--color-primary);
    border-radius: var(--radius-full);
  }

  /* Mobile menu animations - faster and smoother */
  #mobile-menu {
    animation: slideDown var(--motion-duration-quick) var(--motion-ease-standard);
    transition: opacity var(--motion-duration-quick) var(--motion-ease-standard), 
                transform var(--motion-duration-quick) var(--motion-ease-standard);
  }

  @keyframes slideDown {
    from {
      opacity: 0;
      transform: translateY(-8px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  #mobile-menu-backdrop {
    animation: fadeIn var(--motion-duration-quick) var(--motion-ease-standard);
    transition: opacity var(--motion-duration-quick) var(--motion-ease-standard);
  }

  @keyframes fadeIn {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }
}

@layer utilities {
  /* Blog Prose Enhancements - Using Design Tokens */
  .prose h2 {
    color: var(--color-text);
    font-weight: var(--font-weight-bold);
    font-size: var(--font-size-3xl);
    margin-top: 2.5rem;
    margin-bottom: 1rem;
    padding-bottom: 0.75rem;
    border-bottom: 2px solid var(--color-border);
    position: relative;
    line-height: 1.3;
  }

  .prose h2:first-child {
    margin-top: 0;
  }

  .prose h3 {
    color: var(--color-text);
    font-weight: var(--font-weight-semibold);
    font-size: var(--font-size-2xl);
    margin-top: 1.75rem;
    margin-bottom: 0.75rem;
    line-height: 1.4;
  }

  .prose h3:first-child {
    margin-top: 0;
  }

  .prose ul > li::marker {
    color: var(--color-text-muted);
    font-weight: var(--font-weight-bold);
  }

  .prose strong {
    color: var(--color-text);
    font-weight: var(--font-weight-semibold);
  }

  /* Inline code (not in pre blocks) */
  .prose code:not(pre code) {
    color: var(--color-primary);
    font-weight: var(--font-weight-medium);
    background: var(--color-subtle);
    padding: 0.125rem 0.375rem;
    border-radius: var(--radius-xs);
  }

  .prose blockquote {
    border-left: 4px solid var(--color-primary);
    background: var(--color-subtle);
    border-radius: var(--radius-lg);
    padding: 1.5rem;
    margin: 1.5rem 0;
  }

  .prose a {
    color: var(--color-primary);
    text-decoration: underline;
    text-decoration-thickness: 2px;
    text-underline-offset: 2px;
    transition: opacity var(--motion-duration-quick) var(--motion-ease-standard);
  }

  .prose a:hover {
    opacity: 0.8;
  }

  .prose p {
    color: var(--color-text-muted);
    line-height: 1.625;
    margin-top: 0;
    margin-bottom: 1.25rem;
  }

  /* Ensure proper spacing after headings */
  .prose h2 + p,
  .prose h3 + p {
    margin-top: 0.5rem;
  }

  /* Code Block Styling - Using Design Tokens */
  .prose pre {
    background: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    padding: 1.5rem;
    margin-top: 1.75rem;
    margin-bottom: 1.75rem;
    overflow-x: auto;
    box-shadow: var(--shadow-xs);
  }

  /* Extra spacing when code blocks follow headings or paragraphs */
  .prose p + pre,
  .prose h2 + pre,
  .prose h3 + pre,
  .prose ul + pre,
  .prose ol + pre {
    margin-top: 1.25rem;
  }

  /* Extra spacing before paragraphs following code blocks */
  .prose pre + p,
  .prose pre + h2,
  .prose pre + h3,
  .prose pre + ul,
  .prose pre + ol {
    margin-top: 1.5rem;
  }

  .prose pre code {
    color: var(--color-text);
    padding: 0;
    background: transparent;
    border-radius: 0;
    font-size: var(--font-size-sm);
    line-height: 1.6;
  }

  /* Code Block Syntax Highlighting - Light Theme (matching reference) */

  /* Light theme syntax tokens */
  .prose pre code .token.comment,
  .prose pre code .token.prolog,
  .prose pre code .token.doctype,
  .prose pre code .token.cdata {
    color: #6a737d; /* gray for comments */
  }

  .prose pre code .token.property,
  .prose pre code .token.tag,
  .prose pre code .token.constant,
  .prose pre code .token.symbol,
  .prose pre code .token.deleted {
    color: #008080; /* teal for property names/keys */
  }

  .prose pre code .token.string,
  .prose pre code .token.char,
  .prose pre code .token.attr-value,
  .prose pre code .token.builtin,
  .prose pre code .token.inserted {
    color: #22863a; /* green for string values */
  }

  .prose pre code .token.keyword,
  .prose pre code .token.boolean,
  .prose pre code .token.null {
    color: #005cc5; /* blue for keywords/booleans */
  }

  .prose pre code .token.number {
    color: #e36209; /* orange for numbers */
  }

  .prose pre code .token.function,
  .prose pre code .token.class-name {
    color: #6f42c1; /* purple for functions */
  }

  .prose pre code .token.punctuation,
  .prose pre code .token.operator {
    color: #24292e; /* dark gray for punctuation */
  }

  .prose pre code .token.attr-name,
  .prose pre code .token.selector {
    color: #005cc5; /* blue for attribute names */
  }

  /* Alert components for inline feedback */
  .alert {
    padding: 1rem;
    border-left: 4px solid;
    border-radius: var(--radius-md);
    margin: 1rem 0;
    background: var(--color-subtle);
  }

  .alert-neutral {
    border-left-color: var(--color-border);
    color: var(--color-text);
  }

  .alert-success {
    border-left-color: var(--color-success);
    color: var(--color-success);
  }

  .alert-warning {
    border-left-color: var(--color-warning);
    color: var(--color-warning);
  }

  .alert-danger {
    border-left-color: var(--color-danger);
    color: var(--color-danger);
  }

}
