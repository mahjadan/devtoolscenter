@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  /* Design Token System */
  :root {
    color-scheme: light dark;
    font-family: var(--font-sans);
    
    /* Base tokens - theme agnostic */
    --font-sans: "Inter", "Segoe UI", system-ui, sans-serif;
    --font-mono: "Fira Code", "Courier New", monospace;
    
    /* Font sizes */
    --font-size-xs: 0.75rem;
    --font-size-sm: 0.875rem;
    --font-size-base: 1rem;
    --font-size-lg: 1.125rem;
    --font-size-xl: 1.25rem;
    --font-size-2xl: 1.5rem;
    --font-size-3xl: 1.875rem;
    
    /* Font weights */
    --font-weight-regular: 400;
    --font-weight-medium: 500;
    --font-weight-semibold: 600;
    --font-weight-bold: 700;
    
    /* Border radius */
    --radius-xs: 4px;
    --radius-sm: 6px;
    --radius-md: 8px;
    --radius-lg: 12px;
    --radius-full: 9999px;
    
    /* Motion */
    --motion-duration-quick: 120ms;
    --motion-duration-normal: 200ms;
    --motion-duration-slow: 320ms;
    --motion-ease-standard: cubic-bezier(0.2, 0, 0, 1);
    --motion-ease-emphasized: cubic-bezier(0.3, 0.7, 0.4, 1);
    
    /* Elevation - base values, adjusted per theme */
    --shadow-xs: 0 1px 2px rgba(var(--shadow-color-base-rgb), 0.08);
    --shadow-sm: 0 4px 12px rgba(var(--shadow-color-base-rgb), 0.12);
    --shadow-md: 0 12px 24px rgba(var(--shadow-color-base-rgb), 0.16);
  }
  
  /* Light theme tokens */
  :root[data-theme="light"] {
    --color-bg: #f8fafc;
    --color-surface: #ffffff;
    --color-subtle: #f1f5f9;
    --color-border: #cbd5e1;
    --color-text: #0f172a;
    --color-text-muted: #475569;
    --color-primary: #0284c7;
    --color-primary-contrast: #ffffff;
    --color-accent: #16a34a;
    --color-success: #15803d;
    --color-warning: #b45309;
    --color-danger: #dc2626;
    --shadow-color-base: rgba(15, 23, 42, 0.12);
    --shadow-color-base-rgb: 15, 23, 42;
  }
  
  /* Dark theme tokens */
  :root[data-theme="dark"] {
    --color-bg: #0b1120;
    --color-surface: #111c2f;
    --color-subtle: #1b2538;
    --color-border: #3f4a63;
    --color-text: #e2e8f0;
    --color-text-muted: #94a3b8;
    --color-primary: #38bdf8;
    --color-primary-contrast: #041423;
    --color-accent: #4ade80;
    --color-success: #22c55e;
    --color-warning: #f59e0b;
    --color-danger: #f87171;
    --shadow-color-base: rgba(8, 15, 30, 0.32);
    --shadow-color-base-rgb: 8, 15, 30;
  }

  body {
    @apply bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100 transition-colors duration-200;
  }

  code,
  pre {
    @apply font-mono;
  }
}

@layer components {
  .btn {
    @apply px-4 py-2 rounded-lg font-medium transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2;
  }

  .btn-primary {
    @apply bg-primary-600 hover:bg-primary-700 text-white focus:ring-primary-500;
  }

  .btn-secondary {
    @apply bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 text-gray-900 dark:text-gray-100 focus:ring-gray-500;
  }

  .btn-accent {
    @apply bg-accent-600 hover:bg-accent-700 text-white focus:ring-accent-500;
  }

  .tool-textarea {
    @apply w-full min-h-[200px] p-4 font-mono text-sm border-2 border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent resize-y;
  }

  .tool-card {
    @apply bg-white dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 rounded-xl p-6 hover:border-primary-500 dark:hover:border-primary-400 transition-all duration-200 hover:shadow-lg;
  }

  /* Enhanced Blog Article Styles - Light Mode (default) */
  .article-hero-gradient {
    background: linear-gradient(
      135deg,
      #eff6ff 0%,
      #dbeafe 40%,
      #bfdbfe 70%,
      #dbeafe 100%
    ) !important;
    box-shadow: 0 10px 30px rgba(37, 99, 235, 0.1),
      0 0 0 1px rgba(37, 99, 235, 0.05) !important;
    position: relative;
  }

  /* Light mode glow effect */
  .article-hero-gradient::after {
    content: "";
    position: absolute;
    inset: 0;
    background: linear-gradient(
      135deg,
      rgba(59, 130, 246, 0.05) 0%,
      transparent 50%,
      rgba(59, 130, 246, 0.05) 100%
    );
    pointer-events: none;
    border-radius: inherit;
  }

  /* Dark Mode - only apply when .dark class is present */
  .dark .article-hero-gradient {
    background: linear-gradient(
      135deg,
      rgba(15, 23, 42, 0.95) 0%,
      rgba(30, 41, 59, 0.9) 50%,
      rgba(15, 23, 42, 0.95) 100%
    ) !important;
    box-shadow: 0 10px 40px rgba(56, 189, 248, 0.15),
      0 0 0 1px rgba(56, 189, 248, 0.1) !important;
  }

  /* Hide light mode glow in dark mode */
  .dark .article-hero-gradient::after {
    display: none;
  }

  .code-block-enhanced pre {
    position: relative;
    background: #ffffff !important;
    border: 1px solid #e5e7eb;
    @apply rounded-xl shadow-lg transition-all duration-300;
  }

  .code-block-enhanced pre:hover {
    border-color: #d1d5db;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08);
  }

  .code-block-enhanced pre code {
    @apply text-gray-900;
  }

  /* Dark mode code blocks */
  .code-block-enhanced pre:is(.dark *) {
    background: #1e293b !important;
    border: 1px solid #334155;
  }

  .code-block-enhanced pre:hover:is(.dark *) {
    border-color: #10b981;
    box-shadow: 0 8px 24px rgba(16, 185, 129, 0.15);
  }

  .code-block-enhanced pre code:is(.dark *) {
    @apply text-gray-100;
  }

  .metadata-icon {
    @apply w-[18px] h-[18px] text-gray-600 dark:text-gray-400;
  }

  .article-animate {
    animation: fadeInUp 0.6s ease-out;
  }

  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
}

@layer components {
  /* Screen reader only utility - shown on focus */
  .sr-only {
    @apply absolute w-px h-px p-0 -m-px overflow-hidden whitespace-nowrap border-0;
    clip: rect(0, 0, 0, 0);
  }

  .sr-only.focus\:not-sr-only:focus {
    @apply static w-auto h-auto p-2 m-0 overflow-visible whitespace-normal;
    clip: auto;
  }

  /* Navigation link active states */
  .nav-link.active,
  .mobile-nav-link.active {
    @apply text-primary-600 dark:text-primary-400 font-semibold bg-primary-50 dark:bg-primary-900/20;
  }

  .nav-link {
    @apply relative;
  }

  .nav-link.active::after {
    content: "";
    @apply absolute bottom-0 left-0 right-0 h-0.5 bg-primary-600 dark:bg-primary-400 rounded-full;
  }

  /* Mobile menu animations - faster and smoother */
  #mobile-menu {
    animation: slideDown 0.15s ease-out;
    transition: opacity 0.15s ease-out, transform 0.15s ease-out;
  }

  @keyframes slideDown {
    from {
      opacity: 0;
      transform: translateY(-8px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  #mobile-menu-backdrop {
    animation: fadeIn 0.15s ease-out;
    transition: opacity 0.15s ease-out;
  }

  @keyframes fadeIn {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }
}

@layer utilities {
  /* Blog Prose Enhancements - Unified with Homepage Colors with Better Contrast */
  .prose h2 {
    @apply text-gray-900 dark:text-gray-50 font-bold;
    margin-top: 2.5rem;
    margin-bottom: 1rem;
    padding-bottom: 0.75rem;
    border-bottom: 2px solid;
    @apply border-gray-300 dark:border-primary-400;
    position: relative;
    font-size: 1.875rem;
    line-height: 1.3;
  }

  .prose h2:first-child {
    margin-top: 0;
  }

  .prose h3 {
    @apply text-gray-900 dark:text-gray-100 font-semibold;
    margin-top: 1.75rem;
    margin-bottom: 0.75rem;
    font-size: 1.5rem;
    line-height: 1.4;
  }

  .prose h3:first-child {
    margin-top: 0;
  }

  .prose ul > li::marker {
    @apply text-gray-600 dark:text-gray-400 font-bold;
  }

  .prose strong {
    @apply text-gray-900 dark:text-white font-semibold;
  }

  /* Inline code (not in pre blocks) */
  .prose code:not(pre code) {
    @apply text-primary-600 dark:text-primary-400 font-medium bg-primary-50 dark:bg-primary-900/20 px-1.5 py-0.5 rounded;
  }

  .prose blockquote {
    @apply border-l-4 border-l-primary-500 dark:border-l-primary-400 bg-gray-50 dark:bg-gray-800/50 rounded-lg px-6 py-4 my-6;
  }

  .prose a {
    @apply text-primary-600 dark:text-primary-400 underline decoration-2 underline-offset-2 hover:text-primary-700 dark:hover:text-primary-300;
  }

  .prose p {
    @apply text-gray-700 dark:text-gray-300 leading-relaxed;
    margin-top: 0;
    margin-bottom: 1.25rem;
  }

  /* Ensure proper spacing after headings */
  .prose h2 + p,
  .prose h3 + p {
    margin-top: 0.5rem;
  }

  /* Code Block Styling - Better margins and padding */
  .prose pre {
    @apply bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg;
    padding: 1.5rem;
    margin-top: 1.75rem;
    margin-bottom: 1.75rem;
    overflow-x: auto;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
  }

  /* Extra spacing when code blocks follow headings or paragraphs */
  .prose p + pre,
  .prose h2 + pre,
  .prose h3 + pre,
  .prose ul + pre,
  .prose ol + pre {
    margin-top: 1.25rem;
  }

  /* Extra spacing before paragraphs following code blocks */
  .prose pre + p,
  .prose pre + h2,
  .prose pre + h3,
  .prose pre + ul,
  .prose pre + ol {
    margin-top: 1.5rem;
  }

  .prose pre code {
    @apply text-gray-900;
    padding: 0;
    background: transparent;
    border-radius: 0;
    font-size: 0.875rem;
    line-height: 1.6;
  }

  /* Code Block Syntax Highlighting - Light Theme (matching reference) */

  /* Light theme syntax tokens */
  .prose pre code .token.comment,
  .prose pre code .token.prolog,
  .prose pre code .token.doctype,
  .prose pre code .token.cdata {
    color: #6a737d; /* gray for comments */
  }

  .prose pre code .token.property,
  .prose pre code .token.tag,
  .prose pre code .token.constant,
  .prose pre code .token.symbol,
  .prose pre code .token.deleted {
    color: #008080; /* teal for property names/keys */
  }

  .prose pre code .token.string,
  .prose pre code .token.char,
  .prose pre code .token.attr-value,
  .prose pre code .token.builtin,
  .prose pre code .token.inserted {
    color: #22863a; /* green for string values */
  }

  .prose pre code .token.keyword,
  .prose pre code .token.boolean,
  .prose pre code .token.null {
    color: #005cc5; /* blue for keywords/booleans */
  }

  .prose pre code .token.number {
    color: #e36209; /* orange for numbers */
  }

  .prose pre code .token.function,
  .prose pre code .token.class-name {
    color: #6f42c1; /* purple for functions */
  }

  .prose pre code .token.punctuation,
  .prose pre code .token.operator {
    color: #24292e; /* dark gray for punctuation */
  }

  .prose pre code .token.attr-name,
  .prose pre code .token.selector {
    color: #005cc5; /* blue for attribute names */
  }

  /* Dark mode code blocks */
  .prose pre:is(.dark *) {
    @apply bg-gray-800 border-gray-700;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
  }

  .prose pre code:is(.dark *) {
    @apply text-gray-100;
  }

  .prose pre code:is(.dark *) .token.comment,
  .prose pre code:is(.dark *) .token.prolog,
  .prose pre code:is(.dark *) .token.doctype,
  .prose pre code:is(.dark *) .token.cdata {
    color: #8b949e;
  }

  .prose pre code:is(.dark *) .token.property,
  .prose pre code:is(.dark *) .token.tag,
  .prose pre code:is(.dark *) .token.constant,
  .prose pre code:is(.dark *) .token.symbol,
  .prose pre code:is(.dark *) .token.deleted {
    color: #79c0ff;
  }

  .prose pre code:is(.dark *) .token.string,
  .prose pre code:is(.dark *) .token.char,
  .prose pre code:is(.dark *) .token.attr-value,
  .prose pre code:is(.dark *) .token.builtin,
  .prose pre code:is(.dark *) .token.inserted {
    color: #a5d6ff;
  }

  .prose pre code:is(.dark *) .token.keyword,
  .prose pre code:is(.dark *) .token.boolean,
  .prose pre code:is(.dark *) .token.null {
    color: #ff7b72;
  }

  .prose pre code:is(.dark *) .token.number {
    color: #79c0ff;
  }

  .prose pre code:is(.dark *) .token.function,
  .prose pre code:is(.dark *) .token.class-name {
    color: #d2a8ff;
  }

  .prose pre code:is(.dark *) .token.punctuation,
  .prose pre code:is(.dark *) .token.operator {
    color: #c9d1d9;
  }

  .prose pre code:is(.dark *) .token.attr-name,
  .prose pre code:is(.dark *) .token.selector {
    color: #79c0ff;
  }
}
